<!DOCTYPE html>
<!--
  Group Delivery Lead Data Import Page
  - Upload and preview CSV data files.
  - Client-side parsing and validation.
-->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Import | MyISP</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>

    <header>
        <div class="brand-area">
            <span class="logo-text">Company Name</span>
            <span class="app-name">MyISP</span>
        </div>
        <div class="user-controls">
            <span class="user-name">Hardman, Daniel (Group Delivery Lead)</span>
            <a href="#" class="logout-link">Log Out</a>
        </div>
    </header>

    <nav class="global-nav">
        <a href="group-delivery-lead-dashboard.html">Enterprise Overview</a>
        <a href="group-delivery-lead-reports.html">Reports</a>
        <a href="group-delivery-lead-import-data.html" class="active">Data Import</a>
        <a href="group-delivery-lead-settings.html">Settings</a>
    </nav>

    <div class="main-container">
        <h1 class="page-title">Import Skill Data</h1>

        <div class="content-panel">
            <h3>Upload CSV File</h3>
            <p style="font-size: 12px; color: #666; margin-bottom: 20px;">
                Upload a CSV file containing employee skill data. The file must include all required columns as per the data model.
            </p>

            <div id="drop-zone" style="border: 2px dashed #ccc; border-radius: 8px; padding: 60px 20px; text-align: center; background: #f9f9f9; cursor: pointer;">
                <div style="font-size: 48px; color: #999; margin-bottom: 15px;">üìÅ</div>
                <p style="font-size: 14px; color: #666; margin: 10px 0;">Drag and drop your CSV file here</p>
                <p style="font-size: 12px; color: #999;">or</p>
                <input type="file" id="file-input" accept=".csv" style="display: none;">
                <button class="btn btn-primary" onclick="document.getElementById('file-input').click();">Browse Files</button>
            </div>

            <div id="file-info" style="display: none; margin-top: 20px; padding: 15px; background: #e8f4f8; border-radius: 5px;">
                <strong>File:</strong> <span id="filename"></span><br>
                <strong>Records Found:</strong> <span id="record-count">0</span>
            </div>
        </div>

        <div id="preview-panel" class="content-panel" style="display: none;">
            <h3>Data Preview</h3>
            <p style="font-size: 11px; color: #999; margin-bottom: 15px;">Showing first 10 rows</p>
            <div style="overflow-x: auto; max-height: 400px;">
                <table id="preview-table">
                    <thead id="preview-header"></thead>
                    <tbody id="preview-body"></tbody>
                </table>
            </div>
            <div style="margin-top: 20px;">
                <button class="btn btn-primary">Confirm Import</button>
                <button class="btn btn-secondary" onclick="resetImport();">Cancel</button>
            </div>
        </div>

    </div>

    <footer>
        &copy; 2026 Company Name Corporation. All rights reserved. For Internal Use Only.
    </footer>

    <script>
        const dropZone = document.getElementById('drop-zone');
        const fileInput = document.getElementById('file-input');
        const fileInfo = document.getElementById('file-info');
        const previewPanel = document.getElementById('preview-panel');

        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.style.borderColor = '#1a5490';
            dropZone.style.background = '#e8f4f8';
        });

        dropZone.addEventListener('dragleave', () => {
            dropZone.style.borderColor = '#ccc';
            dropZone.style.background = '#f9f9f9';
        });

        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.style.borderColor = '#ccc';
            dropZone.style.background = '#f9f9f9';
            const file = e.dataTransfer.files[0];
            if (file && file.name.endsWith('.csv')) {
                processFile(file);
            }
        });

        fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                processFile(file);
            }
        });

        function processFile(file) {
            document.getElementById('filename').textContent = file.name;
            const reader = new FileReader();
            reader.onload = (e) => {
                const text = e.target.result;
                const lines = text.split('\n').filter(line => line.trim());
                const recordCount = lines.length - 1;
                document.getElementById('record-count').textContent = recordCount;
                fileInfo.style.display = 'block';
                generatePreview(lines);
            };
            reader.readAsText(file);
        }

        function generatePreview(lines) {
            const headers = lines[0].split(',');
            const previewHeader = document.getElementById('preview-header');
            const previewBody = document.getElementById('preview-body');

            previewHeader.innerHTML = '<tr>' + headers.map(h => `<th>${h.trim()}</th>`).join('') + '</tr>';

            const previewLines = lines.slice(1, 11);
            previewBody.innerHTML = previewLines.map(line => {
                const cells = line.split(',');
                return '<tr>' + cells.map(cell => `<td>${cell.trim()}</td>`).join('') + '</tr>';
            }).join('');

            previewPanel.style.display = 'block';
        }

        function resetImport() {
            fileInfo.style.display = 'none';
            previewPanel.style.display = 'none';
            fileInput.value = '';
        }
    </script>

</body>
</html>
